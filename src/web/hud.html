<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GanjaMon AI - Neural Interface</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Orbitron:wght@500;700;900&family=Exo+2:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Dark Neutral Base - Less Purple */
            --bg-deep: #0a0a0a;
            --bg-panel: #111111;
            --bg-elevated: #1a1a1a;
            --border: #2a2a2a;

            /* Rasta Palette - DOMINANT */
            --rasta-green: #00d924;
            --rasta-gold: #ffc700;
            --rasta-red: #ff3300;
            --leaf-green: #228b22;

            /* Monad Accent - SUBTLE undertones only */
            --monad-purple: #7c3aed;
            --monad-glow: rgba(124, 58, 237, 0.2);
            --monad-soft: #6d28d9;

            /* Semantic */
            --positive: #2ecc40;
            --negative: #ff4136;
            --warning: #ffd700;
            --info: #00d4ff;
            --twitter-blue: #1da1f2;

            /* Text */
            --text-primary: #ffffff;
            --text-secondary: #b8b8b8;
            --text-muted: #666666;
            --text-label: #ffd700;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Exo 2', sans-serif;
            background: var(--bg-deep);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* ========== HEADER ========== */
        .header {
            background: linear-gradient(180deg, var(--bg-elevated) 0%, var(--bg-panel) 100%);
            border-bottom: 2px solid var(--rasta-green);
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
            box-shadow: 0 4px 20px rgba(0, 217, 36, 0.15);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .logo {
            font-family: 'Orbitron', monospace;
            font-size: 22px;
            font-weight: 900;
            background: linear-gradient(135deg, var(--rasta-green), var(--rasta-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px var(--monad-glow);
            letter-spacing: 2px;
        }

        .header-stat {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 16px;
            border-left: 1px solid var(--border);
        }

        .header-stat:first-of-type { border-left: none; }

        .stat-label {
            font-size: 9px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--text-muted);
            margin-bottom: 2px;
        }

        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .stat-value.positive { color: var(--positive); }
        .stat-value.negative { color: var(--negative); }
        .stat-value.gold { color: var(--rasta-gold); }
        .stat-value.purple { color: var(--rasta-green); }

        .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--bg-deep);
            border-radius: 20px;
            border: 1px solid var(--positive);
        }

        .status-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--positive);
            box-shadow: 0 0 10px var(--positive);
            animation: pulse-glow 2s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% { opacity: 1; box-shadow: 0 0 10px var(--positive); }
            50% { opacity: 0.6; box-shadow: 0 0 20px var(--positive); }
        }

        .status-text {
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .clock {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 700;
            color: var(--rasta-gold);
            text-shadow: 0 0 10px rgba(255, 199, 0, 0.3);
        }

        /* ========== MAIN LAYOUT ========== */
        .main-container {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr 380px;
            grid-template-rows: 1fr 1fr;
            gap: 16px;
            padding: 16px;
            min-height: 0;
        }

        /* ========== PANEL SLOTS ========== */
        .panel-slot {
            background: var(--bg-panel);
            border-radius: 12px;
            border: 1px solid var(--border);
            overflow: hidden;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .panel-slot::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--rasta-green), var(--rasta-gold), var(--rasta-red));
            opacity: 0.8;
        }

        .slot-1::before { background: linear-gradient(90deg, var(--leaf-green), var(--rasta-green)); }
        .slot-2::before { background: linear-gradient(90deg, var(--info), var(--monad-purple)); }
        .slot-3::before { background: linear-gradient(90deg, var(--rasta-gold), var(--warning)); }
        .slot-4::before { background: linear-gradient(90deg, var(--monad-purple), var(--monad-soft)); }

        .panel-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: var(--bg-elevated);
            border-bottom: 1px solid var(--border);
            flex-shrink: 0;
            cursor: pointer;
            user-select: none;
        }

        .panel-title {
            font-family: 'Orbitron', monospace;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--text-label);
        }

        .panel-badge {
            font-size: 9px;
            padding: 3px 8px;
            border-radius: 10px;
            background: var(--rasta-green);
            color: #000;
            font-weight: 600;
        }

        .panel-content {
            flex: 1;
            padding: 16px;
            display: flex;
            flex-direction: column;
            min-height: 0;
            position: relative;
        }

        /* Panel transition */
        .panel-content.transitioning {
            animation: panel-transition 0.6s ease-out;
        }

        @keyframes panel-transition {
            0% { opacity: 0; transform: scale(0.98); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* ========== NEURAL ACTIVITY STREAM ========== */
        .neural-stream {
            grid-row: 1 / 3;
            background: var(--bg-panel);
            border-radius: 12px;
            border: 1px solid var(--rasta-gold);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 199, 0, 0.15);
        }

        .neural-header {
            padding: 16px;
            background: linear-gradient(180deg, var(--bg-elevated), var(--bg-panel));
            border-bottom: 1px solid var(--rasta-gold);
            text-align: center;
        }

        .neural-title {
            font-family: 'Orbitron', monospace;
            font-size: 14px;
            font-weight: 700;
            color: var(--rasta-gold);
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 15px rgba(255, 199, 0, 0.4);
        }

        .neural-subtitle {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .neural-feed {
            flex: 1;
            overflow: hidden;
            position: relative;
            padding: 8px;
        }

        .neural-item {
            background: var(--bg-deep);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            border-left: 3px solid var(--monad-purple);
            animation: neural-slide-in 0.4s ease-out;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            line-height: 1.5;
        }

        @keyframes neural-slide-in {
            0% { opacity: 0; transform: translateY(-20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .neural-item.thinking { border-left-color: var(--monad-purple); }
        .neural-item.signal { border-left-color: var(--rasta-gold); }
        .neural-item.action { border-left-color: var(--rasta-green); }
        .neural-item.learning { border-left-color: var(--info); }
        .neural-item.alert { border-left-color: var(--rasta-red); }
        .neural-item.decision { border-left-color: var(--text-primary); }
        .neural-item.social { border-left-color: var(--twitter-blue); }
        .neural-item.plant { border-left-color: var(--leaf-green); }
        .neural-item.trade { border-left-color: var(--rasta-gold); background: rgba(255, 215, 0, 0.1); }
        .neural-item.prediction { border-left-color: var(--monad-soft); }

        .neural-time {
            font-size: 9px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .neural-icon {
            margin-right: 8px;
        }

        .neural-text {
            color: var(--text-secondary);
        }

        /* ========== BOTTOM TICKER ========== */
        .bottom-ticker {
            background: var(--bg-panel);
            border-top: 2px solid var(--rasta-green);
            padding: 10px 0;
            flex-shrink: 0;
            overflow: hidden;
            position: relative;
        }

        .ticker-track {
            display: flex;
            animation: ticker-scroll 60s linear infinite;
            white-space: nowrap;
        }

        @keyframes ticker-scroll {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        .ticker-item {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 0 24px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--text-secondary);
        }

        .ticker-item .icon { font-size: 14px; }
        .ticker-item .time { color: var(--text-muted); }
        .ticker-item.positive .text { color: var(--positive); }
        .ticker-item.negative .text { color: var(--negative); }
        .ticker-item.gold .text { color: var(--rasta-gold); }

        /* ========== PANEL CONTENT STYLES ========== */

        /* Webcam Panel */
        .webcam-container {
            flex: 1;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            background: #000;
        }

        .webcam-feed {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .webcam-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 16px;
            background: linear-gradient(transparent, rgba(0,0,0,0.8));
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .webcam-stat {
            text-align: center;
        }

        .webcam-stat-value {
            font-family: 'Orbitron', monospace;
            font-size: 24px;
            font-weight: 700;
            color: var(--rasta-green);
            text-shadow: 0 0 10px var(--rasta-green);
        }

        .webcam-stat-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
        }

        /* Gauge Components */
        .gauges-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            flex: 1;
        }

        .gauge-card {
            background: var(--bg-deep);
            border-radius: 10px;
            padding: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid var(--border);
            position: relative;
            overflow: hidden;
        }

        .gauge-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--rasta-green);
            transform: scaleX(var(--fill, 0.5));
            transform-origin: left;
            transition: transform 0.5s ease-out;
        }

        .gauge-card.warning::after { background: var(--rasta-gold); }
        .gauge-card.danger::after { background: var(--rasta-red); }

        .gauge-label {
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .gauge-value {
            font-family: 'Orbitron', monospace;
            font-size: 32px;
            font-weight: 700;
            color: var(--text-primary);
            line-height: 1;
        }

        .gauge-unit {
            font-size: 14px;
            color: var(--text-muted);
            margin-left: 4px;
        }

        .gauge-status {
            font-size: 10px;
            margin-top: 8px;
            padding: 3px 10px;
            border-radius: 10px;
            background: rgba(46, 204, 64, 0.2);
            color: var(--rasta-green);
        }

        .gauge-status.warning { background: rgba(255, 215, 0, 0.2); color: var(--rasta-gold); }
        .gauge-status.danger { background: rgba(255, 65, 54, 0.2); color: var(--rasta-red); }

        .gauge-sparkline {
            width: 100%;
            height: 30px;
            margin-top: 8px;
        }

        /* Device Grid */
        .devices-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .device-card {
            background: var(--bg-deep);
            border-radius: 10px;
            padding: 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 1px solid var(--border);
        }

        .device-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: var(--bg-panel);
        }

        .device-card.on .device-icon {
            background: var(--rasta-green);
            box-shadow: 0 0 20px var(--rasta-green);
        }

        .device-info { flex: 1; }

        .device-name {
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .device-status {
            font-size: 10px;
            color: var(--text-muted);
        }

        .device-card.on .device-status { color: var(--rasta-green); }

        /* Trading Panel */
        .token-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 16px;
        }

        .token-price {
            font-family: 'Orbitron', monospace;
            font-size: 36px;
            font-weight: 700;
        }

        .token-change {
            font-size: 14px;
            padding: 4px 10px;
            border-radius: 6px;
        }

        .token-change.positive { background: rgba(46, 204, 64, 0.2); color: var(--positive); }
        .token-change.negative { background: rgba(255, 65, 54, 0.2); color: var(--negative); }

        .mini-chart {
            flex: 1;
            background: var(--bg-deep);
            border-radius: 8px;
            padding: 12px;
            position: relative;
        }

        .chart-canvas {
            width: 100%;
            height: 100%;
        }

        .token-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .token-stat {
            text-align: center;
            padding: 12px;
            background: var(--bg-deep);
            border-radius: 8px;
        }

        .token-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 16px;
            font-weight: 700;
            color: var(--rasta-gold);
        }

        .token-stat-label {
            font-size: 9px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 4px;
        }

        /* Alpha Radar */
        .radar-container {
            flex: 1;
            display: flex;
            gap: 16px;
        }

        .radar-visual {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: var(--bg-deep);
            border: 2px solid var(--rasta-green);
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .radar-sweep {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, var(--rasta-green), transparent);
            transform-origin: left center;
            animation: radar-spin 3s linear infinite;
        }

        @keyframes radar-spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .radar-rings {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .radar-ring {
            position: absolute;
            border: 1px solid var(--border);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .radar-blip {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--rasta-gold);
            box-shadow: 0 0 10px var(--rasta-gold);
            animation: blip-pulse 1s ease-in-out infinite;
        }

        @keyframes blip-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.5); opacity: 0.5; }
        }

        .signals-list {
            flex: 1;
            overflow-y: auto;
        }

        .signal-item {
            padding: 12px;
            background: var(--bg-deep);
            border-radius: 8px;
            margin-bottom: 8px;
            border-left: 3px solid var(--rasta-gold);
        }

        .signal-source {
            font-size: 10px;
            color: var(--text-muted);
            margin-bottom: 4px;
        }

        .signal-content {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .signal-confidence {
            font-size: 10px;
            color: var(--rasta-gold);
            margin-top: 4px;
        }

        /* Strategy Panel */
        .strategy-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .strategy-stat {
            text-align: center;
            padding: 16px;
            background: var(--bg-deep);
            border-radius: 10px;
        }

        .strategy-stat-value {
            font-family: 'Orbitron', monospace;
            font-size: 24px;
            font-weight: 700;
        }

        .strategy-stat-value.positive { color: var(--positive); }

        .learning-log {
            flex: 1;
            overflow-y: auto;
        }

        .learning-entry {
            padding: 10px;
            background: var(--bg-deep);
            border-radius: 6px;
            margin-bottom: 6px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            border-left: 2px solid var(--info);
        }

        .learning-time {
            color: var(--text-muted);
            font-size: 9px;
        }

        /* Social Panel */
        .social-stats {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
        }

        .social-stat {
            flex: 1;
            text-align: center;
            padding: 12px;
            background: var(--bg-deep);
            border-radius: 8px;
        }

        .social-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 700;
            color: var(--twitter-blue);
        }

        .recent-posts {
            flex: 1;
            overflow-y: auto;
        }

        .post-card {
            padding: 12px;
            background: var(--bg-deep);
            border-radius: 8px;
            margin-bottom: 8px;
            border: 1px solid var(--border);
        }

        .post-text {
            font-size: 12px;
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .post-stats {
            display: flex;
            gap: 16px;
            font-size: 11px;
            color: var(--text-muted);
        }

        /* Growth Dashboard */
        .growth-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .growth-day {
            font-family: 'Orbitron', monospace;
            font-size: 48px;
            font-weight: 900;
            color: var(--rasta-green);
            text-shadow: 0 0 20px var(--rasta-green);
        }

        .growth-stage {
            font-size: 14px;
            padding: 6px 16px;
            background: var(--leaf-green);
            border-radius: 20px;
            font-weight: 600;
        }

        .milestones {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .milestone {
            padding: 8px 12px;
            background: var(--bg-deep);
            border-radius: 6px;
            font-size: 11px;
            border: 1px solid var(--border);
        }

        .milestone.completed {
            border-color: var(--rasta-green);
            color: var(--rasta-green);
        }

        .milestone.current {
            border-color: var(--rasta-gold);
            color: var(--rasta-gold);
            animation: pulse-border 2s infinite;
        }

        @keyframes pulse-border {
            0%, 100% { box-shadow: 0 0 0 0 var(--rasta-gold); }
            50% { box-shadow: 0 0 10px 2px var(--rasta-gold); }
        }

        /* Positions Panel */
        .positions-list {
            flex: 1;
            overflow-y: auto;
        }

        .position-row {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--bg-deep);
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .position-token {
            flex: 1;
            font-weight: 600;
        }

        .position-pnl {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 700;
        }

        .position-pnl.positive { color: var(--positive); }
        .position-pnl.negative { color: var(--negative); }

        .pnl-total {
            padding: 16px;
            background: var(--bg-deep);
            border-radius: 10px;
            text-align: center;
            margin-top: 12px;
        }

        .pnl-total-value {
            font-family: 'Orbitron', monospace;
            font-size: 28px;
            font-weight: 700;
            color: var(--positive);
        }

        .pnl-total-label {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 4px;
        }

        /* Multi-chain Panel */
        .chain-cards {
            display: flex;
            gap: 16px;
            margin-bottom: 16px;
        }

        .chain-card {
            flex: 1;
            padding: 16px;
            background: var(--bg-deep);
            border-radius: 10px;
            text-align: center;
        }

        .chain-name {
            font-size: 12px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .chain-balance {
            font-family: 'JetBrains Mono', monospace;
            font-size: 18px;
            font-weight: 700;
        }

        .bridge-status {
            padding: 16px;
            background: var(--bg-deep);
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .bridge-icon {
            font-size: 24px;
        }

        .bridge-info { flex: 1; }

        .bridge-label {
            font-size: 10px;
            color: var(--text-muted);
        }

        .bridge-status-text {
            color: var(--positive);
            font-weight: 600;
        }

        /* Background particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: -1;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            opacity: 0.3;
            animation: float-particle 20s ease-in-out infinite;
        }

        @keyframes float-particle {
            0%, 100% { transform: translateY(0) translateX(0); }
            25% { transform: translateY(-30px) translateX(15px); }
            50% { transform: translateY(-10px) translateX(-10px); }
            75% { transform: translateY(-40px) translateX(5px); }
        }

        /* Hidden panels */
        .panel-template { display: none; }

        /* LOW-POWER MODE: Kill all infinite CSS animations for Chromebook kiosk */
        .particle { display: none !important; }
        .ticker-track { animation: none !important; }
        .radar-circle { animation: none !important; }
        .radar-blip { animation: none !important; }
        .status-dot { animation: none !important; }
        .webcam-live-badge { animation: none !important; }
    </style>
</head>
<body>
    <!-- Background Particles -->
    <div class="particles" id="particles"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <div class="logo">GANJAMON AI</div>
            <div class="header-stat">
                <span class="stat-label">Day</span>
                <span class="stat-value gold" id="header-day">--</span>
            </div>
            <div class="header-stat">
                <span class="stat-label">Stage</span>
                <span class="stat-value" id="header-stage">--</span>
            </div>
            <div class="header-stat">
                <span class="stat-label">Strain</span>
                <span class="stat-value" id="header-strain">GDP Runtz</span>
            </div>
            <div class="header-stat">
                <span class="stat-label">$MON</span>
                <span class="stat-value positive" id="header-price">--</span>
            </div>
            <div class="header-stat">
                <span class="stat-label">24h</span>
                <span class="stat-value" id="header-change">--</span>
            </div>
            <div class="header-stat">
                <span class="stat-label">Gas</span>
                <span class="stat-value purple" id="header-gas">--</span>
            </div>
        </div>
        <div class="header-right">
            <div class="status-indicator">
                <div class="status-dot" id="status-dot"></div>
                <span class="status-text" id="status-text">ONLINE</span>
            </div>
            <div class="clock" id="clock">14:23:47</div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
        <!-- Slot 1: Plant -->
        <div class="panel-slot slot-1" id="slot-1">
            <div class="panel-header">
                <span class="panel-title" id="slot-1-title">Live Camera</span>
                <span class="panel-badge" id="slot-1-badge">PLANT</span>
            </div>
            <div class="panel-content" id="slot-1-content">
                <!-- Content injected by JS -->
            </div>
        </div>

        <!-- Slot 2: Environment -->
        <div class="panel-slot slot-2" id="slot-2">
            <div class="panel-header">
                <span class="panel-title" id="slot-2-title">Climate Command</span>
                <span class="panel-badge" id="slot-2-badge">ENV</span>
            </div>
            <div class="panel-content" id="slot-2-content">
                <!-- Content injected by JS -->
            </div>
        </div>

        <!-- Slot 3: Market -->
        <div class="panel-slot slot-3" id="slot-3">
            <div class="panel-header">
                <span class="panel-title" id="slot-3-title">$MON Dashboard</span>
                <span class="panel-badge" id="slot-3-badge">MARKET</span>
            </div>
            <div class="panel-content" id="slot-3-content">
                <!-- Content injected by JS -->
            </div>
        </div>

        <!-- Slot 4: Brain -->
        <div class="panel-slot slot-4" id="slot-4">
            <div class="panel-header">
                <span class="panel-title" id="slot-4-title">Alpha Radar</span>
                <span class="panel-badge" id="slot-4-badge">BRAIN</span>
            </div>
            <div class="panel-content" id="slot-4-content">
                <!-- Content injected by JS -->
            </div>
        </div>

        <!-- Neural Activity Stream -->
        <aside class="neural-stream">
            <div class="neural-header">
                <div class="neural-title">Neural Activity</div>
                <div class="neural-subtitle">Real-time agent consciousness</div>
            </div>
            <div class="neural-feed" id="neural-feed">
                <!-- Neural items injected by JS -->
            </div>
        </aside>
    </main>

    <!-- Bottom Ticker -->
    <footer class="bottom-ticker">
        <div class="ticker-track" id="ticker-track">
            <!-- Ticker items injected by JS -->
        </div>
    </footer>

    <script>
        // ============ CONFIGURATION ============
        // Auto-detect API: if on port 8000, use same origin. Otherwise, try localhost:8000
        const API_BASE = window.location.hostname === 'grokandmon.com'
            ? 'https://grokandmon.com'
            : window.location.port === '8000'
                ? window.location.origin
                : 'http://localhost:8000';
        const ROTATION_INTERVAL = 60000; // 60 seconds (was 30)
        const NEURAL_INTERVAL = 15000; // New neural item every 15 seconds (was 3)
        const DATA_REFRESH_INTERVAL = 30000; // Refresh data every 30 seconds (was 10)
        const MAX_NEURAL_ITEMS = 8; // was 15

        // ============ STATE ============
        const state = {
            sensors: {},
            devices: {},
            ai: {},
            token: {},
            stage: {},
            trading: {},
            consciousness: {},
            social: {},
            signals: {},
            learning: {},
            identity: {},
            agentTasks: [],
            isOnline: true,
            slotPanels: {
                1: ['camera', 'growth', 'timelapse'],
                2: ['climate', 'devices', 'history'],
                3: ['token', 'positions', 'identity'],
                4: ['radar', 'strategy', 'consciousness']
            },
            slotIndex: { 1: 0, 2: 0, 3: 0, 4: 0 },
            neuralItems: [],
            tickerItems: []
        };

        // ============ PANEL TEMPLATES ============
        const panelTemplates = {
            camera: () => `
                <div class="webcam-container">
                    <img class="webcam-feed" id="webcam-feed"
                         src="${API_BASE}/api/webcam/stream"
                         alt="Live feed"
                         onerror="this.onerror=null; this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 400 300%22><rect fill=%22%23111%22 width=%22400%22 height=%22300%22/><text x=%22200%22 y=%22150%22 text-anchor=%22middle%22 fill=%22%2300d924%22 font-family=%22monospace%22 font-size=%2216%22>Connecting to camera...</text></svg>';">
                    <div class="webcam-overlay">
                        <div class="webcam-stat">
                            <div class="webcam-stat-value">${state.stage.current_day || '--'}</div>
                            <div class="webcam-stat-label">Day</div>
                        </div>
                        <div class="webcam-stat">
                            <div class="webcam-stat-value">${state.sensors.vpd_kpa?.toFixed(2) || '--'}</div>
                            <div class="webcam-stat-label">VPD</div>
                        </div>
                        <div class="webcam-stat">
                            <div class="webcam-stat-value">${state.ai.health_score ? state.ai.health_score + '%' : '--'}</div>
                            <div class="webcam-stat-label">Health</div>
                        </div>
                    </div>
                </div>
            `,

            growth: () => `
                <div class="growth-header">
                    <div>
                        <div class="growth-day">${state.stage.current_day || '--'}</div>
                        <div style="color: var(--text-muted); font-size: 12px;">Days in grow</div>
                    </div>
                    <div class="growth-stage">${state.stage.current_stage || '--'}</div>
                </div>
                <div class="milestones">
                    <div class="milestone completed">Germination</div>
                    <div class="milestone completed">Seedling</div>
                    <div class="milestone current">Vegetative</div>
                    <div class="milestone">Pre-flower</div>
                    <div class="milestone">Flowering</div>
                    <div class="milestone">Harvest</div>
                </div>
                <div style="margin-top: auto; padding-top: 16px; text-align: center; color: var(--text-muted);">
                    <div style="font-size: 12px;">Estimated Harvest</div>
                    <div style="font-family: 'Orbitron', monospace; font-size: 18px; color: var(--text-muted);">${state.stage.days_to_harvest ? '~' + state.stage.days_to_harvest + ' days' : '--'}</div>
                </div>
            `,

            timelapse: () => `
                <div style="flex: 1; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                    <div style="font-size: 48px; margin-bottom: 16px;">üé¨</div>
                    <div style="color: var(--text-muted);">7-Day Timelapse</div>
                    <div style="margin-top: 16px; padding: 12px 24px; background: var(--bg-deep); border-radius: 8px;">
                        <span style="color: var(--rasta-green);">Loading frames...</span>
                    </div>
                </div>
            `,

            climate: () => {
                const temp = state.sensors.temperature_f || state.sensors.air_temp;
                const humidity = state.sensors.humidity_percent || state.sensors.humidity;
                const vpd = state.sensors.vpd_kpa || state.sensors.vpd;
                const co2 = state.sensors.co2_ppm || state.sensors.co2;
                const hasData = temp || humidity || vpd || co2;

                if (!hasData) {
                    return `
                        <div style="flex: 1; display: flex; align-items: center; justify-content: center; flex-direction: column;">
                            <div style="font-size: 24px; margin-bottom: 16px;">üå°Ô∏è</div>
                            <div style="color: var(--rasta-gold); font-size: 14px;">Connecting to sensors...</div>
                            <div style="color: var(--text-muted); font-size: 11px; margin-top: 8px;">Waiting for Chromebook API</div>
                        </div>
                    `;
                }

                return `
                    <div class="gauges-grid">
                        <div class="gauge-card" style="--fill: ${temp ? (temp - 15) / 20 : 0}">
                            <div class="gauge-label">Temperature</div>
                            <div class="gauge-value">${temp ? temp.toFixed(1) : '--'}<span class="gauge-unit">¬∞C</span></div>
                            <div class="gauge-status">${temp ? (temp * 9/5 + 32).toFixed(0) + '¬∞F' : '--'}</div>
                        </div>
                        <div class="gauge-card" style="--fill: ${humidity ? humidity / 100 : 0}">
                            <div class="gauge-label">Humidity</div>
                            <div class="gauge-value">${humidity ? humidity.toFixed(0) : '--'}<span class="gauge-unit">%</span></div>
                            <div class="gauge-status">${humidity ? 'Live' : '--'}</div>
                        </div>
                        <div class="gauge-card" style="--fill: ${vpd ? vpd / 2 : 0}">
                            <div class="gauge-label">VPD</div>
                            <div class="gauge-value">${vpd ? vpd.toFixed(2) : '--'}<span class="gauge-unit">kPa</span></div>
                            <div class="gauge-status">${vpd ? 'Live' : '--'}</div>
                        </div>
                        <div class="gauge-card" style="--fill: ${co2 ? co2 / 1500 : 0}">
                            <div class="gauge-label">CO2</div>
                            <div class="gauge-value">${co2 ? co2.toFixed(0) : '--'}<span class="gauge-unit">ppm</span></div>
                            <div class="gauge-status">${co2 ? 'Live' : '--'}</div>
                        </div>
                    </div>
                `;
            },

            devices: () => {
                const hasData = Object.keys(state.devices).length > 0;
                const getStatus = (key, onText, offText) => {
                    if (!hasData) return '--';
                    return state.devices[key] ? onText : offText;
                };
                return `
                <div class="devices-grid">
                    <div class="device-card ${state.devices.grow_light ? 'on' : ''}">
                        <div class="device-icon">üí°</div>
                        <div class="device-info">
                            <div class="device-name">Grow Light</div>
                            <div class="device-status">${getStatus('grow_light', 'ON', 'OFF')}</div>
                        </div>
                    </div>
                    <div class="device-card ${state.devices.exhaust_fan ? 'on' : ''}">
                        <div class="device-icon">üå¨Ô∏è</div>
                        <div class="device-info">
                            <div class="device-name">Exhaust Fan</div>
                            <div class="device-status">${getStatus('exhaust_fan', 'ON', 'OFF')}</div>
                        </div>
                    </div>
                    <div class="device-card ${state.devices.circulation_fan ? 'on' : ''}">
                        <div class="device-icon">üîÑ</div>
                        <div class="device-info">
                            <div class="device-name">Circ Fan</div>
                            <div class="device-status">${getStatus('circulation_fan', 'ON', 'OFF')}</div>
                        </div>
                    </div>
                    <div class="device-card ${state.devices.water_pump ? 'on' : ''}">
                        <div class="device-icon">üíß</div>
                        <div class="device-info">
                            <div class="device-name">Water Pump</div>
                            <div class="device-status">${getStatus('water_pump', 'ON', 'Standby')}</div>
                        </div>
                    </div>
                </div>
            `},

            history: () => `
                <div style="flex: 1; display: flex; align-items: center; justify-content: center;">
                    <div style="text-align: center;">
                        <div style="font-size: 14px; color: var(--text-muted); margin-bottom: 16px;">24-Hour Environmental History</div>
                        <svg width="300" height="150" style="background: var(--bg-deep); border-radius: 8px;">
                            <text x="150" y="65" fill="var(--text-muted)" font-size="12" text-anchor="middle">Awaiting sensor data...</text>
                            <text x="150" y="85" fill="var(--text-muted)" font-size="10" text-anchor="middle">Connect to Chromebook API</text>
                        </svg>
                        <div style="display: flex; justify-content: center; gap: 24px; margin-top: 12px; font-size: 11px;">
                            <span style="color: var(--text-muted);">‚óè Temp</span>
                            <span style="color: var(--text-muted);">‚óè Humidity</span>
                            <span style="color: var(--text-muted);">‚óè VPD</span>
                        </div>
                    </div>
                </div>
            `,

            token: () => {
                const price = state.token.price_usd || state.token.price || 0;
                const volume = state.token.volume_24h || state.token.volume24h || 0;
                const mcap = state.token.market_cap || state.token.marketCap || 0;
                const change = state.token.price_change_24h ?? state.token.priceChange24h;
                const hasPrice = price > 0;
                const hasChange = change !== undefined && change !== null;
                const changeClass = hasChange && change >= 0 ? 'positive' : (hasChange ? 'negative' : '');
                const changeSign = hasChange && change >= 0 ? '+' : '';
                return `
                <div class="token-header">
                    <div class="token-price" id="token-price">${hasPrice ? '$' + (price >= 0.001 ? price.toFixed(4) : price.toExponential(2)) : '--'}</div>
                    <div class="token-change ${changeClass}" style="${!hasChange ? 'color: var(--text-muted);' : ''}">${hasChange ? changeSign + change.toFixed(1) + '%' : '--'}</div>
                </div>
                <div class="mini-chart">
                    ${hasPrice ? `
                    <iframe src="https://dexscreener.com/monad/0xca4ab8db4052541731adcb6e383baf5a731a2ffe?embed=1&theme=dark&trades=0&info=0" style="width:100%;height:100%;border:none;border-radius:4px;"></iframe>
                    ` : `
                    <svg width="100%" height="100%" viewBox="0 0 300 100" preserveAspectRatio="none">
                        <text x="150" y="45" fill="var(--text-muted)" font-size="12" text-anchor="middle">Awaiting price feed...</text>
                        <text x="150" y="65" fill="var(--text-muted)" font-size="10" text-anchor="middle">LFJ Token Mill</text>
                    </svg>
                    `}
                </div>
                <div class="token-stats">
                    <div class="token-stat">
                        <div class="token-stat-value">${volume > 0 ? (volume >= 1000 ? '$' + (volume/1000).toFixed(1) + 'k' : '$' + volume.toFixed(0)) : '--'}</div>
                        <div class="token-stat-label">Volume 24h</div>
                    </div>
                    <div class="token-stat">
                        <div class="token-stat-value">${mcap > 0 ? (mcap >= 1000 ? '$' + (mcap/1000).toFixed(1) + 'k' : '$' + mcap.toFixed(0)) : '--'}</div>
                        <div class="token-stat-label">Market Cap</div>
                    </div>
                    <div class="token-stat">
                        <div class="token-stat-value">${state.token.holders || '--'}</div>
                        <div class="token-stat-label">Holders</div>
                    </div>
                </div>
            `},

            positions: () => {
                const t = state.trading || {};
                const cash = t.cash != null ? t.cash.toFixed(2) : '--';
                const starting = t.starting || 1000;
                const pnlPct = t.cash != null ? (((t.cash - starting) / starting) * 100).toFixed(1) : '--';
                const pnlColor = t.cash >= starting ? 'var(--positive)' : 'var(--negative)';
                const openTrades = (t.open_trades || []);
                const closedTrades = (t.recent_closed || []);
                const cycles = t.research_cycles || 0;

                let tradesHtml = '';
                if (openTrades.length > 0) {
                    openTrades.slice(0, 5).forEach(tr => {
                        const pnl = tr.pnl_pct != null ? tr.pnl_pct.toFixed(1) : '0';
                        const pColor = parseFloat(pnl) >= 0 ? 'var(--positive)' : 'var(--negative)';
                        tradesHtml += `<div class="position-row">
                            <div class="position-token" style="font-size:11px;">${tr.symbol || '??'} <span style="color:var(--text-muted);font-size:9px;">${tr.chain || ''}</span></div>
                            <div class="position-pnl" style="color:${pColor};font-size:11px;">${pnl}%</div>
                        </div>`;
                    });
                } else {
                    tradesHtml = '<div style="color:var(--text-muted);font-size:10px;text-align:center;padding:8px;">No open positions</div>';
                }

                return `
                <div style="text-align: center; padding: 8px; background: var(--bg-deep); border-radius: 8px; margin-bottom: 8px; font-size: 10px; color: var(--rasta-gold);">
                    PAPER TRADING | ${cycles.toLocaleString()} Research Cycles
                </div>
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                    <div style="text-align:center;flex:1;">
                        <div style="font-size:18px;font-weight:700;color:${pnlColor};">$${cash}</div>
                        <div style="font-size:9px;color:var(--text-muted);">Cash / $${starting}</div>
                    </div>
                    <div style="text-align:center;flex:1;">
                        <div style="font-size:18px;font-weight:700;color:${pnlColor};">${pnlPct}%</div>
                        <div style="font-size:9px;color:var(--text-muted);">Total PnL</div>
                    </div>
                </div>
                <div style="display:flex;justify-content:space-around;margin-bottom:8px;padding:6px;background:var(--bg-deep);border-radius:6px;">
                    <div style="text-align:center;"><span style="color:var(--rasta-green);font-size:14px;font-weight:700;">${openTrades.length}</span><div style="font-size:8px;color:var(--text-muted);">OPEN</div></div>
                    <div style="text-align:center;"><span style="color:var(--text-secondary);font-size:14px;font-weight:700;">${closedTrades.length}</span><div style="font-size:8px;color:var(--text-muted);">CLOSED</div></div>
                </div>
                <div class="positions-list" style="max-height:100px;overflow-y:auto;">
                    ${tradesHtml}
                </div>
                <div style="margin-top:8px;display:flex;justify-content:space-between;font-size:9px;color:var(--text-muted);padding:4px 8px;background:var(--bg-deep);border-radius:4px;">
                    <span>60% compound</span><span>25% $MON</span><span>10% $GANJA</span><span>5% burn</span>
                </div>`;
            },

            identity: () => {
                const id = state.identity || {};
                const rep = id.reputation?.score || '--';
                const tools = id.services?.mcp?.tools_count || 20;
                const services = typeof id.services === 'object' ? Object.keys(id.services || {}).length : 0;
                return `
                <div style="text-align:center;padding:10px;background:linear-gradient(135deg, rgba(124,58,237,0.15), rgba(0,217,36,0.1));border-radius:8px;margin-bottom:10px;">
                    <div style="font-size:10px;color:var(--monad-purple);letter-spacing:2px;">ERC-8004 AUTONOMOUS AGENT</div>
                    <div style="font-size:24px;font-weight:900;font-family:'Orbitron';color:var(--rasta-gold);margin:4px 0;">Agent #${id.agent_id || '4'}</div>
                    <div style="font-size:10px;color:var(--text-muted);">on Monad (Chain 143)</div>
                </div>
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;margin-bottom:8px;">
                    <div style="text-align:center;padding:6px;background:var(--bg-deep);border-radius:6px;">
                        <div style="font-size:16px;font-weight:700;color:var(--rasta-green);">${tools}</div>
                        <div style="font-size:8px;color:var(--text-muted);">MCP TOOLS</div>
                    </div>
                    <div style="text-align:center;padding:6px;background:var(--bg-deep);border-radius:6px;">
                        <div style="font-size:16px;font-weight:700;color:var(--info);">${services}</div>
                        <div style="font-size:8px;color:var(--text-muted);">SERVICES</div>
                    </div>
                    <div style="text-align:center;padding:6px;background:var(--bg-deep);border-radius:6px;">
                        <div style="font-size:16px;font-weight:700;color:var(--rasta-gold);">${rep}</div>
                        <div style="font-size:8px;color:var(--text-muted);">REPUTATION</div>
                    </div>
                </div>
                <div style="font-size:9px;color:var(--text-muted);padding:6px;background:var(--bg-deep);border-radius:4px;">
                    <div style="margin-bottom:3px;"><span style="color:var(--text-label);">A2A:</span> grokandmon.com/a2a/v1</div>
                    <div style="margin-bottom:3px;"><span style="color:var(--text-label);">Bridge:</span> Wormhole NTT (Monad + Base)</div>
                    <div><span style="color:var(--text-label);">Registry:</span> 0x8004BAa...dB63</div>
                </div>`;
            },

            radar: () => {
                const sig = state.signals || {};
                const domains = sig.domains || {};
                const total = sig.total_signals || 0;
                const isImbalanced = sig.imbalanced || false;
                const stuckOn = sig.dominant_source;
                const dominantPct = sig.dominant_pct || 0;

                const domainColors = {
                    on_chain: 'var(--rasta-green)',
                    perps: 'var(--info)',
                    prediction: 'var(--rasta-gold)',
                    social: 'var(--monad-purple)',
                    dev_signal: 'var(--twitter-blue)'
                };

                let barsHtml = '';
                Object.entries(domains).forEach(([name, info]) => {
                    const pct = ((info.pct || 0) * 100).toFixed(1);
                    const count = (info.signals || 0).toLocaleString();
                    const color = domainColors[name] || 'var(--text-secondary)';
                    const isStuck = (name === stuckOn && isImbalanced);
                    const barBg = isStuck ? 'rgba(255,51,0,0.3)' : 'var(--bg-deep)';
                    barsHtml += `
                    <div style="margin-bottom:4px;padding:4px 6px;background:${barBg};border-radius:4px;${isStuck ? 'border:1px solid var(--negative);' : ''}">
                        <div style="display:flex;justify-content:space-between;font-size:9px;margin-bottom:2px;">
                            <span style="color:${color};font-weight:600;text-transform:uppercase;">${name.replace('_',' ')}</span>
                            <span style="color:var(--text-muted);">${count} (${pct}%)</span>
                        </div>
                        <div style="height:4px;background:var(--border);border-radius:2px;overflow:hidden;">
                            <div style="height:100%;width:${Math.min(parseFloat(pct), 100)}%;background:${color};border-radius:2px;"></div>
                        </div>
                    </div>`;
                });

                const statusText = isImbalanced
                    ? `STUCK on ${stuckOn} (${dominantPct.toFixed(0)}%)`
                    : 'BALANCED';
                const statusColor = isImbalanced ? 'var(--negative)' : 'var(--positive)';

                return `
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                    <div style="font-size:10px;color:var(--rasta-gold);letter-spacing:1px;">SIGNAL DOMAINS</div>
                    <div style="font-size:10px;color:${statusColor};font-weight:700;">${statusText}</div>
                </div>
                <div style="text-align:center;margin-bottom:8px;font-size:20px;font-weight:900;font-family:'Orbitron';color:var(--rasta-green);">
                    ${total.toLocaleString()} <span style="font-size:10px;color:var(--text-muted);">signals scanned</span>
                </div>
                ${barsHtml}
                ${isImbalanced ? `<div style="margin-top:6px;padding:6px;background:rgba(255,51,0,0.1);border:1px solid var(--negative);border-radius:4px;font-size:9px;color:var(--negative);">Auto-correction: Reducing ${stuckOn} frequency</div>` : ''}`;
            },

            strategy: () => {
                const learn = state.learning || {};
                const ralph = learn.ralph || learn.ralph_loop || {};
                const assess = typeof learn.latest_assessment === 'object' ? learn.latest_assessment : {};
                const winRate = assess.win_rate != null ? (assess.win_rate * 100).toFixed(0) : '--';
                const wrColor = parseFloat(winRate) >= 55 ? 'var(--positive)' : parseFloat(winRate) > 0 ? 'var(--warning)' : 'var(--text-muted)';

                return `
                <div style="font-size:10px;color:var(--rasta-gold);margin-bottom:8px;text-align:center;letter-spacing:1px;">SELF-IMPROVEMENT ENGINE</div>
                <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:6px;margin-bottom:8px;">
                    <div style="text-align:center;padding:8px 4px;background:var(--bg-deep);border-radius:6px;">
                        <div style="font-size:18px;font-weight:700;color:${wrColor};">${winRate}%</div>
                        <div style="font-size:8px;color:var(--text-muted);">WIN RATE</div>
                    </div>
                    <div style="text-align:center;padding:8px 4px;background:var(--bg-deep);border-radius:6px;">
                        <div style="font-size:18px;font-weight:700;color:var(--rasta-green);">${ralph.deployed || 0}</div>
                        <div style="font-size:8px;color:var(--text-muted);">DEPLOYED</div>
                    </div>
                    <div style="text-align:center;padding:8px 4px;background:var(--bg-deep);border-radius:6px;">
                        <div style="font-size:18px;font-weight:700;color:var(--info);">${ralph.total || 0}</div>
                        <div style="font-size:8px;color:var(--text-muted);">RALPH REQS</div>
                    </div>
                </div>
                <div style="padding:6px;background:var(--bg-deep);border-radius:4px;margin-bottom:6px;">
                    <div style="font-size:9px;color:var(--text-label);margin-bottom:4px;">Learning Loops (12 active)</div>
                    <div style="font-size:9px;color:var(--text-secondary);line-height:1.6;">
                        Meta Detection / Agent Learning / Self-Modification / Weight Decay / Token Discovery / Feedback Analysis / Source Hunting / Tooling Discovery / Performance Tracking / Self-Assessment / Repo Scanning / <span style="color:var(--rasta-gold);">Consciousness</span>
                    </div>
                </div>
                <div style="padding:6px;background:var(--bg-deep);border-radius:4px;">
                    <div style="font-size:9px;color:var(--text-label);margin-bottom:3px;">Ralph Loop</div>
                    <div style="font-size:9px;color:var(--text-muted);">
                        ${ralph.pending || 0} pending | ${ralph.deployed || 0} deployed | ${ralph.total || 0} total
                    </div>
                </div>`;
            },

            social: () => {
                const soc = state.social || {};
                const platforms = soc.platforms || {};
                const totalPosts = soc.total_posts || 0;
                const ogProfiles = soc.og_profiles_tracked || 0;

                const platIcons = { farcaster: 'FC', twitter: 'TW', telegram: 'TG', moltbook: 'MB', email: 'EM', clawk: 'CK' };
                const platColors = { farcaster: 'var(--monad-purple)', twitter: 'var(--twitter-blue)', telegram: 'var(--info)', moltbook: 'var(--rasta-gold)', email: 'var(--rasta-green)', clawk: 'var(--warning)' };

                let platHtml = '';
                Object.entries(platforms).forEach(([name, info]) => {
                    const count = info.post_count || 0;
                    const icon = platIcons[name] || name.slice(0,2).toUpperCase();
                    const color = platColors[name] || 'var(--text-secondary)';
                    platHtml += `
                    <div style="text-align:center;padding:6px;background:var(--bg-deep);border-radius:6px;">
                        <div style="font-size:10px;font-weight:700;color:${color};">${icon}</div>
                        <div style="font-size:14px;font-weight:700;color:var(--text-primary);">${count}</div>
                        <div style="font-size:7px;color:var(--text-muted);text-transform:capitalize;">${name}</div>
                    </div>`;
                });

                return `
                <div style="font-size:10px;color:var(--rasta-gold);margin-bottom:8px;text-align:center;letter-spacing:1px;">SOCIAL COMMAND</div>
                <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                    <div style="text-align:center;flex:1;">
                        <div style="font-size:20px;font-weight:900;color:var(--rasta-green);">${totalPosts}</div>
                        <div style="font-size:8px;color:var(--text-muted);">TOTAL POSTS</div>
                    </div>
                    <div style="text-align:center;flex:1;">
                        <div style="font-size:20px;font-weight:900;color:var(--monad-purple);">${Object.keys(platforms).length}</div>
                        <div style="font-size:8px;color:var(--text-muted);">PLATFORMS</div>
                    </div>
                    <div style="text-align:center;flex:1;">
                        <div style="font-size:20px;font-weight:900;color:var(--rasta-gold);">${ogProfiles}</div>
                        <div style="font-size:8px;color:var(--text-muted);">OG PROFILES</div>
                    </div>
                </div>
                <div style="display:grid;grid-template-columns:repeat(${Math.min(Object.keys(platforms).length, 3)}, 1fr);gap:4px;">
                    ${platHtml}
                </div>`;
            },

            consciousness: () => {
                const c = state.consciousness || {};
                const goals = c.goal_progress || {};
                const stuck = c.stuck;
                const stuckOn = c.stuck_on;
                const monologue = c.inner_monologue || 'Initializing consciousness...';
                const focus = c.focus || 'initializing';

                const goalBar = (label, data, color) => {
                    const score = (data?.score || 0) * 100;
                    const detail = data?.detail || '';
                    return `
                    <div style="margin-bottom:6px;">
                        <div style="display:flex;justify-content:space-between;font-size:9px;margin-bottom:2px;">
                            <span style="color:${color};font-weight:600;">${label}</span>
                            <span style="color:var(--text-muted);">${score.toFixed(0)}%</span>
                        </div>
                        <div style="height:6px;background:var(--border);border-radius:3px;overflow:hidden;">
                            <div style="height:100%;width:${score}%;background:${color};border-radius:3px;transition:width 1s;"></div>
                        </div>
                        <div style="font-size:8px;color:var(--text-muted);margin-top:1px;">${detail}</div>
                    </div>`;
                };

                const stuckStyle = stuck
                    ? 'border:1px solid var(--negative);box-shadow:0 0 10px rgba(255,51,0,0.3);'
                    : 'border:1px solid var(--positive);';

                return `
                <div style="padding:8px;background:var(--bg-deep);border-radius:8px;margin-bottom:8px;${stuckStyle}">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;">
                        <div style="font-size:10px;color:var(--rasta-gold);letter-spacing:1px;">CONSCIOUSNESS</div>
                        <div style="font-size:10px;font-weight:700;color:${stuck ? 'var(--negative)' : 'var(--positive)'};">
                            ${stuck ? 'STUCK' : 'FLOWING'}
                        </div>
                    </div>
                    <div style="font-size:9px;color:var(--text-muted);margin-bottom:4px;">
                        Focus: <span style="color:var(--info);">${focus}</span>
                        ${stuckOn ? ` | Fixated on: <span style="color:var(--negative);">${stuckOn}</span>` : ''}
                    </div>
                </div>
                <div style="margin-bottom:8px;">
                    <div style="font-size:9px;color:var(--text-label);margin-bottom:4px;">GOAL PROGRESS</div>
                    ${goalBar('G-1 Make Money', goals.make_money, 'var(--rasta-green)')}
                    ${goalBar('G-2 Grow Plant', goals.grow_plant, 'var(--leaf-green)')}
                    ${goalBar('G-3 Community', goals.build_community, 'var(--monad-purple)')}
                </div>
                <div style="padding:8px;background:var(--bg-deep);border-radius:6px;font-size:9px;color:var(--text-secondary);font-style:italic;line-height:1.4;">
                    "${monologue}"
                </div>`;
            }
        };

        const panelTitles = {
            camera: 'Live Camera',
            growth: 'Growth Dashboard',
            timelapse: '7-Day Timelapse',
            climate: 'Climate Command',
            devices: 'Device Control',
            history: '24hr History',
            token: '$MON Dashboard',
            positions: 'Trading Desk',
            identity: 'Agent Identity',
            radar: 'Signal Radar',
            strategy: 'Self-Improvement',
            social: 'Social Command',
            consciousness: 'Consciousness'
        };

        // ============ NEURAL ACTIVITY GENERATOR ============
        // When disconnected, show waiting messages. When connected, show real activity from AI decisions
        const neuralMessagesOffline = [
            { type: 'thinking', icon: '‚è≥', text: 'Waiting for API connection...' },
            { type: 'thinking', icon: 'üîå', text: 'Chromebook API: connecting...' },
            { type: 'thinking', icon: 'üß†', text: 'Neural interface: standby' },
        ];

        const neuralMessagesOnline = [
            // Dynamic messages generated from live state
        ];

        // Use offline messages by default, switch when connected
        let neuralMessages = neuralMessagesOffline;

        // ============ TICKER EVENTS ============
        // Real events will be populated from API - these are placeholders shown only when disconnected
        const tickerEvents = [
            { icon: '‚è≥', text: 'Waiting for Chromebook connection...', type: '' },
            { icon: 'üîå', text: 'API: localhost:8000', type: '' },
            { icon: 'üåø', text: 'GanjaMon AI HUD v1.0', type: 'gold' },
            { icon: 'üì°', text: 'Signal aggregator: standby', type: '' },
            { icon: 'üß†', text: 'Neural interface: initializing', type: '' },
        ];

        // ============ INITIALIZATION ============
        function init() {
            createParticles();
            updateClock();
            setInterval(updateClock, 10000); // every 10s (was 1s)

            // Initial data fetch
            fetchAllData();
            setInterval(fetchAllData, DATA_REFRESH_INTERVAL);

            // Initial render
            renderAllSlots();

            // Click-to-rotate panel headers
            [1, 2, 3, 4].forEach(slotNum => {
                const header = document.querySelector(`#slot-${slotNum} .panel-header`);
                if (header) header.addEventListener('click', () => {
                    state.slotIndex[slotNum] = (state.slotIndex[slotNum] + 1) % state.slotPanels[slotNum].length;
                    renderSlot(slotNum);
                });
            });

            // Start rotations with staggered timing
            setTimeout(() => startRotation(1), 0);
            setTimeout(() => startRotation(2), 8000);
            setTimeout(() => startRotation(3), 15000);
            setTimeout(() => startRotation(4), 23000);

            // Start neural activity
            addNeuralItem();
            setInterval(addNeuralItem, NEURAL_INTERVAL);

            // Initialize ticker
            initTicker();
        }

        // ============ DATA FETCHING ============
        async function fetchJSON(endpoint) {
            try {
                const r = await fetch(`${API_BASE}${endpoint}`);
                return r.ok ? await r.json() : null;
            } catch (e) { return null; }
        }

        async function fetchAllData() {
            const [sensors, devices, ai, stage, token, trading, consciousness, socialData, signals, learning, identity] = await Promise.all([
                fetchJSON('/api/sensors/live'),
                fetchJSON('/api/devices/latest'),
                fetchJSON('/api/ai/latest'),
                fetchJSON('/api/grow/stage'),
                fetchJSON('/api/token/metrics'),
                fetchJSON('/api/agent/trading'),
                fetchJSON('/api/agent/consciousness'),
                fetchJSON('/api/agent/social'),
                fetchJSON('/api/agent/signals'),
                fetchJSON('/api/agent/learning'),
                fetchJSON('/api/agent/identity'),
            ]);

            if (sensors) state.sensors = sensors;
            if (devices) state.devices = devices;
            if (ai) state.ai = ai;
            if (stage) state.stage = stage;
            if (token) state.token = token;
            if (trading) state.trading = trading;
            if (consciousness) state.consciousness = consciousness;
            if (socialData) state.social = socialData;
            if (signals) state.signals = signals;
            if (learning) state.learning = learning;
            if (identity) state.identity = identity;

            // Switch neural messages based on connection status
            const wasOnline = state.isOnline;
            state.isOnline = !!(sensors || devices);

            if (state.isOnline && !wasOnline) {
                // Just came online - switch to real messages and rebuild ticker
                neuralMessages = neuralMessagesOnline;
                addRealNeuralItem('action', '‚úÖ', 'Connected to Chromebook API');
            } else if (!state.isOnline && wasOnline) {
                // Just went offline
                neuralMessages = neuralMessagesOffline;
                addRealNeuralItem('alert', '‚ö†Ô∏è', 'Lost connection to API');
            }

            // Add real AI decision to neural stream if available
            if (ai?.output_text && state.isOnline) {
                const shortText = ai.output_text.substring(0, 60) + '...';
                addRealNeuralItem('thinking', 'üß†', `Grok: ${shortText}`);
            }

            updateHeader();
            updateStatus();

            // Re-render current slots and ticker to show live data
            if (state.isOnline) {
                renderAllSlots();
                rebuildTicker();
            }
        }

        function addRealNeuralItem(type, icon, text) {
            const feed = document.getElementById('neural-feed');
            const time = new Date().toLocaleTimeString('en-US', { hour12: false });

            const item = document.createElement('div');
            item.className = `neural-item ${type}`;
            item.innerHTML = `
                <div class="neural-time">${time}</div>
                <span class="neural-icon">${icon}</span>
                <span class="neural-text">${text}</span>
            `;

            feed.insertBefore(item, feed.firstChild);

            while (feed.children.length > MAX_NEURAL_ITEMS) {
                feed.removeChild(feed.lastChild);
            }
        }

        // ============ HEADER UPDATES ============
        function updateHeader() {
            document.getElementById('header-day').textContent = state.stage.current_day || '--';
            document.getElementById('header-stage').textContent = state.stage.current_stage ? state.stage.current_stage.toUpperCase().slice(0, 3) : '--';

            const tp = state.token.price_usd || state.token.price;
            if (tp) {
                document.getElementById('header-price').textContent = tp >= 0.01 ? `$${tp.toFixed(4)}` : `$${tp.toExponential(2)}`;
            }
            const tc = state.token.price_change_24h;
            if (tc !== undefined && tc !== null) {
                const el = document.getElementById('header-change');
                el.textContent = `${tc >= 0 ? '+' : ''}${tc.toFixed(1)}%`;
                el.style.color = tc >= 0 ? 'var(--positive)' : 'var(--negative)';
            }
        }

        function updateStatus() {
            const dot = document.getElementById('status-dot');
            const text = document.getElementById('status-text');
            if (state.isOnline) {
                dot.style.background = 'var(--positive)';
                text.textContent = 'ONLINE';
            } else {
                dot.style.background = 'var(--negative)';
                text.textContent = 'OFFLINE';
            }
        }

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('en-US', { hour12: false });
        }

        // ============ PANEL ROTATION ============
        function renderSlot(slotNum) {
            const panelName = state.slotPanels[slotNum][state.slotIndex[slotNum]];
            const content = document.getElementById(`slot-${slotNum}-content`);
            const title = document.getElementById(`slot-${slotNum}-title`);

            content.classList.add('transitioning');
            content.innerHTML = panelTemplates[panelName]();
            title.textContent = panelTitles[panelName];

            setTimeout(() => content.classList.remove('transitioning'), 600);
        }

        function renderAllSlots() {
            [1, 2, 3, 4].forEach(renderSlot);
        }

        function startRotation(slotNum) {
            setInterval(() => {
                state.slotIndex[slotNum] = (state.slotIndex[slotNum] + 1) % state.slotPanels[slotNum].length;
                renderSlot(slotNum);
            }, ROTATION_INTERVAL);
        }

        // ============ NEURAL STREAM ============
        function addNeuralItem() {
            const feed = document.getElementById('neural-feed');
            let msg;

            if (state.isOnline) {
                // Generate contextual messages from live state
                const pool = [];
                const s = state.sensors;
                const t = state.trading;
                const c = state.consciousness;
                const sig = state.signals;

                if (s.temp_c) pool.push({ type: 'plant', icon: 'üå°Ô∏è', text: `Tent: ${s.temp_c.toFixed(1)}¬∞C / ${s.humidity_pct?.toFixed(0)}% RH ‚Äî VPD ${s.vpd_kpa?.toFixed(2)} kPa` });
                if (t.cash) pool.push({ type: 'action', icon: 'üí∞', text: `Portfolio: $${t.cash.toFixed(0)} (${((t.cash - (t.starting||1000)) / (t.starting||1000) * 100).toFixed(1)}%) ‚Äî ${(t.open_trades||[]).length} open trades` });
                if (sig.total_signals) pool.push({ type: 'thinking', icon: 'üì°', text: `Scanning ${sig.total_signals.toLocaleString()} signals across ${Object.keys(sig.domains||{}).length} domains` });
                if (c.stuck) pool.push({ type: 'alert', icon: '‚ö†Ô∏è', text: `Stuck on ${c.stuck_on || 'unknown'} ‚Äî need to diversify signal sources` });
                if (c.goal_progress) {
                    const g = c.goal_progress;
                    if (g.make_money) pool.push({ type: 'thinking', icon: 'üéØ', text: `Goals: Money ${(g.make_money.score*100).toFixed(0)}% | Plant ${(g.grow_plant?.score*100||0).toFixed(0)}% | Community ${(g.build_community?.score*100||0).toFixed(0)}%` });
                }
                if (t.research_cycles) pool.push({ type: 'thinking', icon: 'üî¨', text: `Research cycle #${t.research_cycles.toLocaleString()} ‚Äî hunting for alpha...` });

                if (pool.length > 0) {
                    msg = pool[Math.floor(Math.random() * pool.length)];
                } else {
                    msg = { type: 'thinking', icon: 'üß†', text: 'Neural interface: standby' };
                }
            } else {
                msg = neuralMessages[Math.floor(Math.random() * neuralMessages.length)];
            }

            const time = new Date().toLocaleTimeString('en-US', { hour12: false });
            const item = document.createElement('div');
            item.className = `neural-item ${msg.type}`;
            item.innerHTML = `
                <div class="neural-time">${time}</div>
                <span class="neural-icon">${msg.icon}</span>
                <span class="neural-text">${msg.text}</span>
            `;

            feed.insertBefore(item, feed.firstChild);

            // Remove old items
            while (feed.children.length > MAX_NEURAL_ITEMS) {
                feed.removeChild(feed.lastChild);
            }

            // Also add to ticker
            addTickerEvent(msg);
        }

        // ============ TICKER ============
        function initTicker() {
            const track = document.getElementById('ticker-track');
            let html = '';

            // Double the items for seamless loop
            for (let i = 0; i < 2; i++) {
                tickerEvents.forEach(event => {
                    const time = new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });
                    html += `
                        <div class="ticker-item ${event.type}">
                            <span class="icon">${event.icon}</span>
                            <span class="time">${time}</span>
                            <span class="text">${event.text}</span>
                        </div>
                    `;
                });
            }

            track.innerHTML = html;
        }

        function rebuildTicker() {
            const track = document.getElementById('ticker-track');
            const time = new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });
            const s = state.sensors;
            const t = state.trading;
            const sig = state.signals;

            const liveEvents = [
                { icon: '‚úÖ', text: 'Connected to Chromebook API', type: 'positive' },
                { icon: 'üåø', text: `Day ${state.stage.current_day || '?'} ‚Äî ${state.stage.stage_name || 'Growing'}`, type: 'gold' },
            ];
            if (s.temp_c) liveEvents.push({ icon: 'üå°Ô∏è', text: `${s.temp_c.toFixed(1)}¬∞C / ${s.humidity_pct?.toFixed(0)}% RH`, type: '' });
            if (sig.total_signals) liveEvents.push({ icon: 'üì°', text: `${sig.total_signals.toLocaleString()} signals scanned`, type: '' });
            if (t.cash) liveEvents.push({ icon: 'üí∞', text: `Portfolio: $${t.cash.toFixed(0)} (${((t.cash-(t.starting||1000))/(t.starting||1000)*100).toFixed(1)}%)`, type: t.cash >= (t.starting||1000) ? 'positive' : '' });
            if (t.research_cycles) liveEvents.push({ icon: 'üî¨', text: `${t.research_cycles.toLocaleString()} research cycles`, type: '' });
            if (sig.imbalanced) liveEvents.push({ icon: '‚ö†Ô∏è', text: `Stuck on ${sig.dominant_source} (${sig.dominant_pct?.toFixed(0)}%)`, type: '' });
            liveEvents.push({ icon: 'üß†', text: 'GanjaMon AI HUD v1.0', type: 'gold' });

            let html = '';
            for (let i = 0; i < 2; i++) {
                liveEvents.forEach(event => {
                    html += `<div class="ticker-item ${event.type}">
                        <span class="icon">${event.icon}</span>
                        <span class="time">${time}</span>
                        <span class="text">${event.text}</span>
                    </div>`;
                });
            }
            track.innerHTML = html;
        }

        function addTickerEvent(msg) {
            const track = document.getElementById('ticker-track');
            const time = new Date().toLocaleTimeString('en-US', { hour12: false, hour: '2-digit', minute: '2-digit' });

            const item = document.createElement('div');
            item.className = `ticker-item ${msg.type === 'trade' || msg.type === 'signal' ? 'gold' : msg.type === 'action' || msg.type === 'positive' ? 'positive' : ''}`;
            item.innerHTML = `
                <span class="icon">${msg.icon}</span>
                <span class="time">${time}</span>
                <span class="text">${msg.text}</span>
            `;

            track.appendChild(item);
        }

        // ============ PARTICLES ============
        function createParticles() {
            // Disabled for low-power kiosk mode
        }

        // ============ VISIBILITY API ============
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                // Pause animations when tab is hidden
                document.body.style.animationPlayState = 'paused';
            } else {
                document.body.style.animationPlayState = 'running';
            }
        });

        // Start everything
        init();
    </script>
</body>
</html>
